@startuml UpdateAssetActivityDiagram
!theme plain
title UC_TSGD_Update - Chỉnh sửa tài sản giao dịch

start
:Người dùng chọn chức năng "Chỉnh sửa" tài sản
từ tab "Tài sản" trong form hồ sơ công chứng;
:Hệ thống hiển thị form chỉnh sửa với dữ liệu đã có;

if (Loại tài sản?) then (Đất ở/Đất nông nghiệp)
  :Hiển thị form thông tin đất;
  :Người dùng chỉnh sửa thông tin đất;
elseif (Nhà ở)
  :Hiển thị form thông tin nhà;
  :Người dùng chỉnh sửa thông tin nhà;
elseif (Xe ô tô/Xe máy)
  :Hiển thị form thông tin xe;
  :Người dùng chỉnh sửa thông tin xe;
elseif (Khác)
  :Hiển thị form thông tin tài sản khác;
  :Người dùng chỉnh sửa thông tin tài sản khác;
endif

if (Người dùng thay đổi loại tài sản?) then (Có)
  :Hệ thống hiển thị cảnh báo và yêu cầu xác nhận;
  if (Người dùng xác nhận?) then (Có)
    :Hệ thống hiển thị form thông tin mới theo loại tài sản đã chọn;
  else (Không)
    :Hệ thống giữ nguyên loại tài sản cũ;
  endif
endif

:Người dùng bấm nút "Lưu";

:Hệ thống kiểm tra tính hợp lệ của dữ liệu;

if (Dữ liệu hợp lệ?) then (Có)
  :Ghi nhận các thay đổi vào lịch sử;
  :Cập nhật thông tin vào ENT_TaiSan;
  :Cập nhật thông tin chi tiết vào bảng tương ứng theo loại tài sản;
  :Hiển thị thông báo "Cập nhật thông tin tài sản thành công";
  :Cập nhật danh sách tài sản trong tab "Tài sản";
  :Đóng form chỉnh sửa thông tin tài sản;
  stop
else (Không)
  if (Chưa điền thông tin bắt buộc?) then (Có)
    :Hiển thị thông báo yêu cầu điền thông tin bắt buộc;
  elseif (Sai định dạng thông tin?) then (Có)
    :Hiển thị thông báo lỗi "Thông tin không hợp lệ";
  elseif (Thông tin trùng với tài sản khác?) then (Có)
    :Hiển thị thông báo lỗi "Thông tin này đã tồn tại cho tài sản khác trong hồ sơ";
  endif
  :Người dùng chỉnh sửa lại thông tin;
  if (Người dùng chọn "Hủy"?) then (Có)
    :Đóng form, không lưu dữ liệu;
    stop
  elseif (Người dùng chọn "Lưu" lại?) then (Có)
    :Hệ thống kiểm tra lại tính hợp lệ của dữ liệu;
  endif
endif

@enduml